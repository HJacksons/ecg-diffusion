# Electrocardiogram Generation using Diffusion
De-noising diffusion probabilistic models

## Getting started

1. Make sure that you are in the root folder of the project, during development we have used `python 3.9`
2. Install the dependencies with `pip install -r requirements.txt`
3. We use environment variables to control some services in the project but we have included a basic `.env` file in the Source folder to get started quickly

## Dataset

1. Download the PTB dataset files at this [download link](https://drive.google.com/file/d/1M_GrHURlpaGZoc5PLuxwAzCYAW7_RHVf/view?usp=sharing)
2. We have a `data_prepare.py` script which runs pre-processing operations on the raw data but for simplicity we have included the already prepared and split data in the download link
3. Extract the dataset files in an easily accessible directory of your choosing

The dataset folder should look like this:

    Data
      ├── test
      ├── train
      └── validation

## Trained Models

1. The pre-trained models should be inside the main deliverable `.zip` file
2. We have trained several models and organized them in directories
3. Make sure the models are located in an easily accessible directory

## Training

1. To run the training script make sure that you are in the root directory and run the command `python src/train.py`
2. The training script supports the following arguments
   1. `-n` or `--network`: Which network will be trained (`unet`, `diffwave`, `pulse2pulse`)
   2. `-d` or `--dataset`: Prepared dataset path

This script will train a chosen model on the dataset for 1000 epochs and save the model each 10th epoch inside the `/models` directory.

Example: `python src/train.py -n diffwave -d ../Data`

## Testing

1. To run the testing script make sure that you are in the root directory and run the command `python src/test.py`
2. The testing script supports the following arguments
   1. `-n` or `--network`: Which network will be tested (`unet`, `diffwave`, `pulse2pulse`)
   2. `-f` or `--files`: Number of `.csv` files to generate and plot
   3. `-m` or `--models`: Directory path where the pre-trained models are stored

The results of this script will be saved inside the `/data` directory which can be found in the project root. The `/generated` directory contains all the `.csv` files generated by the sampling process and the `/plots` directory will contain the realistic ECG plots on millimeter paper.

Example: `python src/test.py -n diffwave -f 10 -m ../SavedModels`

## Collaborators

Oriana Presacan - s372073@oslomet.no\
Frencis Balla - s371513@oslomet.no\
Jackson Herbert Sinamenye - s371140@oslomet.no
